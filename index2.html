<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>è¡Œå…ˆæ²ç¤ºæ¿</title>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background-color: #eef4f8;
      margin: 0;
      padding: 2rem;
    }

    h1 {
      text-align: center;
      color: #333;
    }

    #board {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      max-width: 600px;
      margin: 2rem auto;
    }

    .person {
      background: white;
      padding: 1.5rem;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.06);
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      align-items: center;
    }

    .person-name {
      font-size: 1.6rem;
      font-weight: bold;
      color: #333;
    }

    .status-label {
      font-size: 1.8rem;
      font-weight: bold;
      padding: 1rem 2rem;
      border-radius: 16px;
      color: white;
      text-align: center;
      min-width: 200px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .status-å›³æ›¸é¤¨ { background-color: #03a9f4; }
    .status-ï¼¤ï¼¸ { background-color: #4caf50; }
    .status-ãã®ä»– { background-color: #607d8b; }
    .status-å¸°å®… { background-color: #f44336; }
    .status-æ›´æ–°ä¸­ { background-color: #9e9e9e; }

    .buttons {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 1rem;
    }

    button {
      padding: 0.6rem 1.2rem;
      font-size: 1rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: transform 0.2s, background-color 0.2s;
      color: white;
    }

    button:hover {
      transform: scale(1.05);
    }

    .btn-å›³æ›¸é¤¨ { background-color: #03a9f4; }
    .btn-ï¼¤ï¼¸ { background-color: #4caf50; }
    .btn-ãã®ä»– { background-color: #607d8b; }
    .btn-å¸°å®… { background-color: #f44336; }

    .loading {
      text-align: center;
      font-style: italic;
      color: #555;
    }
  </style>
</head>
<body>
  <h1>è¡Œå…ˆæ²ç¤ºæ¿</h1>
  <div id="board" class="loading">èª­ã¿è¾¼ã¿ä¸­...</div>

  <script>

const firebaseConfig = {
  apiKey: "AIzaSyB_rAQzoPefwlMHSg2nAtoGc9fSf-WUYIs",
  authDomain: "where-app-2e035.firebaseapp.com",
  databaseURL: "https://where-app-2e035-default-rtdb.firebaseio.com",
  projectId: "where-app-2e035",
  storageBucket: "where-app-2e035.firebasestorage.app",
  messagingSenderId: "484167457619",
  appId: "1:484167457619:web:d7ccd0c430b04d8bc85fa6"
};

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database(app);
    const ref = db.ref("statuses");

    function loadBoard() {
      const board = document.getElementById("board");
      board.innerHTML = "èª­ã¿è¾¼ã¿ä¸­...";

      ref.on("value", (snapshot) => {
        const data = snapshot.val();
        board.innerHTML = "";

        if (!data) {
          board.innerHTML = "è¡¨ç¤ºã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚";
          return;
        }

        Object.entries(data).forEach(([name, status]) => {
          const div = document.createElement("div");
          div.className = "person";
          div.setAttribute("data-name", name);

          const statusClass = `status-label status-${status || 'æœªè¨­å®š'}`;

          div.innerHTML = `
            <div class="person-name">${name}</div>
            <div class="${statusClass}">${status}</div>
            <div class="buttons">
              <button class="btn-å›³æ›¸é¤¨" onclick="updateStatus('${name}', 'å›³æ›¸é¤¨', this)">ğŸ“šå›³æ›¸é¤¨</button>
              <button class="btn-ï¼¤ï¼¸" onclick="updateStatus('${name}', 'ï¼¤ï¼¸', this)">ğŸ’»ï¼¤ï¼¸</button>
              <button class="btn-ãã®ä»–" onclick="updateStatus('${name}', 'ãã®ä»–', this)">ğŸƒâ€ãã®ä»–</button>
              <button class="btn-å¸°å®…" onclick="updateStatus('${name}', 'å¸°å®…', this)">ğŸ å¸°å®…</button>
            </div>
          `;
          board.appendChild(div);
        });
      });
    }

    function updateStatus(name, status, button) {
      const personDiv = button.closest(".person");
      const statusLabel = personDiv.querySelector(".status-label");
      const originalStatus = statusLabel.textContent;

      statusLabel.textContent = "æ›´æ–°ä¸­...";
      statusLabel.className = "status-label status-æ›´æ–°ä¸­";

      ref.child(name).set(status)
        .then(() => {
          // æ›´æ–°å®Œäº†å¾Œã¯ä½•ã‚‚ã—ãªãã¦ã‚‚ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§æ›´æ–°ã•ã‚Œã‚‹
        })
        .catch((e) => {
          statusLabel.textContent = originalStatus;
          statusLabel.className = `status-label status-${originalStatus}`;
          alert("ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ");
          console.error("æ›´æ–°ã‚¨ãƒ©ãƒ¼:", e);
        });
    }

    loadBoard();
  </script>
</body>
</html>
